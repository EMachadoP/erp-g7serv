{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
 <div class="d-flex justify-content-between align-items-center mb-4">
 <h2>Recibos</h2>
 <a href="{% url 'financeiro:receipt_create' %}" class="btn btn-warning text-white">Novo Recibo Avulso</a>
 </div>

 <div class="card mb-4">
 <div class="card-body">
 <form method="get" class="row g-3">
 <div class="col-md-10">
 <input type="text" name="search" class="form-control"
 placeholder="Pesquise por: Descrição, Favorecido ou Número do Recibo."
 value="{{ request.GET.search }}">
 </div>
 <div class="col-md-1">
 <button type="submit" class="btn btn-warning text-white w-100">Pesquisar</button>
 </div>
 <div class="col-md-1">
 <a href="{% url 'financeiro:receipt_list' %}" class="btn btn-outline-secondary w-100">Limpar</a>
 </div>
 </form>
 </div>
 </div>

 <div class="card">
 <div class="card-body p-0">
 <table class="table table-premium table-hover mb-0">
 <thead class="bg-light">
 <tr>
 <th class="ps-4">Recibo</th>
 <th>Valor</th>
 <th>Tipo de Recibo</th>
 <th>Ações</th>
 </tr>
 </thead>
 <tbody>
 {% for receipt in receipts %}
 <tr>
 <td class="ps-4">
 <div class="fw-bold">Recibo #{{ receipt.id }}/{{ receipt.issue_date|date:"Y" }} - {{ receipt.person.fantasy_name|default:receipt.person.name }}</div>
 <div class="text-muted small">
 <i class="bi bi-calendar-event me-1"></i> Data Emissão: {{ receipt.issue_date|date:"d/m/Y" }}
 </div>
 </td>
 <td class="align-middle">R$ {{ receipt.amount }}</td>
 <td class="align-middle">
 {% if receipt.type == 'RECEIPT' %}
 <span
 class="badge bg-success bg-opacity-25 text-success px-3 py-2 rounded-pill">Recebimento</span>
 {% else %}
 <span
 class="badge bg-danger bg-opacity-25 text-danger px-3 py-2 rounded-pill">Pagamento</span>
 {% endif %}
 </td>
 <td class="align-middle">
 <div class="dropdown">
 <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button"
 data-bs-toggle="dropdown" data-bs-boundary="viewport">
 <i class="bi bi-printer"></i>
 </button>
 <ul class="dropdown-menu">
 <li><a class="dropdown-item" href="{% url 'financeiro:receipt_print' receipt.id %}"
 target="_blank">Imprimir</a></li>
 </ul>
 </div>
 </td>
 </tr>
 {% empty %}
 <tr>
 <td colspan="4" class="text-center py-4 text-muted">Nenhum recibo encontrado.</td>
 </tr>
 {% endfor %}
 </tbody>
 </table>
 </div>
 </div>
 <div class="mt-3 text-muted small">
 {{ receipts.count }} registros
 </div>
</div>
{% endblock %}