{% extends 'base.html' %}

{% block content %}
<div class="row mt-4">
 <div class="col-12 mb-4">
 <h2>Painel Financeiro</h2>
 </div>
</div>

<div class="row mb-4">
 <div class="col-md-4">
 <div class="card text-white bg-danger mb-3">
 <div class="card-header">Total Despesas</div>
 <div class="card-body">
 <h5 class="card-title">R$ {{ total_payables }}</h5>
 </div>
 </div>
 </div>
 <div class="col-md-4">
 <div class="card text-white bg-success mb-3">
 <div class="card-header">Total Receitas</div>
 <div class="card-body">
 <h5 class="card-title">R$ {{ total_receivables }}</h5>
 </div>
 </div>
 </div>
 <div class="col-md-4">
 <div class="card text-white bg-info mb-3">
 <div class="card-header">Saldo</div>
 <div class="card-body">
 <h5 class="card-title">R$ {{ balance }}</h5>
 </div>
 </div>
 </div>
</div>

<div class="row">
 <div class="col-md-6">
 <div class="card h-100">
 <div class="card-header">Últimas Despesas</div>
 <ul class="list-group list-group-flush">
 {% for payable in recent_payables %}
 <li class="list-group-item d-flex justify-content-between align-items-center">
 {{ payable.description }}
 <div class="d-flex align-items-center">
 <span class="badge bg-danger rounded-pill me-3">R$ {{ payable.amount }}</span>
 <div class="dropdown">
 <button class="btn btn-sm btn-light border" type="button" data-bs-toggle="dropdown">
 <i class="bi bi-three-dots-vertical"></i>
 </button>
 <ul class="dropdown-menu">
 <li><a class="dropdown-item"
 href="{% url 'financeiro:account_payable_detail' payable.id %}"><i
 class="bi bi-eye me-2"></i>Detalhes</a></li>
 {% if payable.status != 'PAID' %}
 <li>
 <form action="{% url 'financeiro:account_payable_pay' payable.id %}" method="post"
 class="d-inline">
 {% csrf_token %}
 <button type="submit" class="dropdown-item text-success"
 onclick="return confirm('Confirmar pagamento?')">
 <i class="bi bi-check-circle me-2"></i>Baixar
 </button>
 </form>
 </li>
 {% endif %}
 </ul>
 </div>
 </div>
 </li>
 {% empty %}
 <li class="list-group-item">Nenhuma despesa recente.</li>
 {% endfor %}
 </ul>
 <div class="card-body mt-auto">
 <a href="{% url 'financeiro:account_payable_list' %}" class="card-link">Ver todas</a>
 </div>
 </div>
 </div>
 <div class="col-md-6">
 <div class="card h-100">
 <div class="card-header">Últimas Receitas</div>
 <ul class="list-group list-group-flush">
 {% for receivable in recent_receivables %}
 <li class="list-group-item d-flex justify-content-between align-items-center">
 {{ receivable.description }}
 <div class="d-flex align-items-center">
 <span class="badge bg-success rounded-pill me-3">R$ {{ receivable.amount }}</span>
 <div class="dropdown">
 <button class="btn btn-sm btn-light border" type="button" data-bs-toggle="dropdown">
 <i class="bi bi-three-dots-vertical"></i>
 </button>
 <ul class="dropdown-menu">
 <li><a class="dropdown-item"
 href="{% url 'financeiro:account_receivable_detail' receivable.id %}"><i
 class="bi bi-eye me-2"></i>Detalhes</a></li>
 {% if receivable.status != 'RECEIVED' %}
 <li>
 <form action="{% url 'financeiro:account_receivable_receive' receivable.id %}"
 method="post" class="d-inline">
 {% csrf_token %}
 <button type="submit" class="dropdown-item text-success"
 onclick="return confirm('Confirmar recebimento?')">
 <i class="bi bi-check-circle me-2"></i>Receber
 </button>
 </form>
 </li>
 {% endif %}
 </ul>
 </div>
 </div>
 </li>
 {% empty %}
 <li class="list-group-item">Nenhuma receita recente.</li>
 {% endfor %}
 </ul>
 <div class="card-body mt-auto">
 <a href="{% url 'financeiro:account_receivable_list' %}" class="card-link">Ver todas</a>
 </div>
 </div>
 </div>
</div>
{% endblock %}